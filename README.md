# term-clean

`term-clean` 是一个专为 macOS 用户设计的终端 TUI（命令行图形界面）清理工具，旨在帮助您轻松管理、分析和清理各种包管理器（brew, npm, pnpm, yarn, pip）安装的软件包。

## 🌟 核心特性

- 📦 **多管理器支持**：一站式管理 Homebrew (Formulae & Casks), npm, pnpm, yarn 和 pip。
- 🔍 **智能扫描与分析**：自动检测所有已安装的包，并分析其占用的磁盘空间。
- 🌳 **依赖追溯**：内置递归依赖树构建算法，清晰展示包与包之间的引用关系。
- ⚠️ **安全卸载预览**：在执行卸载前，系统会进行二次确认并显示受影响的依赖项，防止误删系统关键组件。
- ⌨️ **纯键盘交互**：基于 Ink 和 React 构建，提供流畅的 TUI 操作体验。
- � **实时统计**：实时计算选中包的总大小以及可释放的磁盘空间。

## 🚀 快速开始

### 安装

您可以直接通过 npm 全局安装：

```bash
npm install -g term-clean
```

*(注意：目前代码处于开发阶段，您可以克隆仓库后运行 `npm link` 进行测试)*

### 使用方法

#### 交互模式 (TUI)

直接运行命令即可进入交互式界面：

```bash
term-clean
```

进入界面后，您可以使用以下快捷键：

- `↑/↓`：在包列表中上下移动。
- `Tab`：在不同的包管理器标签页（brew, npm, pip 等）之间切换。
- `空格键`：勾选/取消勾选要清理的包。
- `p`：进入预览模式，查看选中包的详细信息及卸载影响分析。
- `c`：在预览模式下按 `c` 确认并执行卸载。
- `r`：刷新扫描结果。
- `q` / `Esc`：退出应用或退出预览模式。

#### 命令行模式 (CLI)

您也可以使用传统的命令行参数：

```bash
# 仅过滤特定的包管理器
term-clean -m brew

# 以调试模式启动（查看详细日志）
term-clean --debug
```

## 🛠️ 开发与测试

如果您希望参与开发或在本地运行项目：

### 环境准备

- Node.js (建议 v18+)
- npm / pnpm / yarn

### 本地运行

1. 克隆仓库
2. 安装依赖：`npm install`
3. 以开发模式运行：`npm run dev`
4. 构建项目：`npm run build`
5. 运行构建后的程序：`node dist/cli.js`

### 测试

项目使用 `vitest` 进行单元测试：

```bash
# 运行所有测试
npm test

# 运行单元测试
npm run test:unit
```

## 🏗️ 架构设计

项目采用分层架构，保证了良好的可扩展性和可维护性：

- **Managers (适配器层)**：统一了不同包管理器的查询和卸载接口（如 `BrewPackageManager`, `NpmPackageManager` 等）。
- **Services (业务逻辑层)**：处理包扫描 (`PackageScannerService`) 和清理流程 (`PackageCleanerService`)。
- **Stores (状态管理)**：使用 `zustand` 管理全局响应式状态（如选中的包、列表数据等）。
- **Components (UI层)**：基于 `ink` 构建的 React 组件库，负责 TUI 界面的渲染。

## 📅 路线图 (Roadmap)

- [x] 多包管理器适配器实现
- [x] 递归依赖分析算法
- [x] 核心 TUI 界面与键盘交互
- [x] 卸载预览与风险预警
- [ ] 导出清理日志到文件
- [ ] 软件包使用频率追踪（智能识别长期未使用的包）
- [ ] 搜索与正则过滤功能增强
- [ ] 依赖树的图形化可视化展示

## 📄 开源协议

本项目基于 MIT 协议开源。

## 🤝 贡献

欢迎提交 Issue 或 Pull Request！如果您觉得这个工具有用，请给它一个 ⭐️。
